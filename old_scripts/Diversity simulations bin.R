for (i in 1:75)
{
  temp = frame
  for (j in 1:555)
  {
    for (k in 1:n)
    {
      p1 = simsp$p1[i]
      p2 = simsp$p2[i]
      p3 = simsp$p3[i]
      x = sggro1m[j,k]
      if (x != 0)
      {
        if (j %in% 1:222)
        {
          if (k %in% common)
          {
            if (p1 == 1)
            {
              p1 = (x^1.05)/((x^1.05) + 100)
            }
            if (p1 == 2)
            {
              p1 = (x^1.05)/((x^1.05) + 300)
            }
            if (p2 == 1)
            {
              p2 = (x^1.05)/((x^1.05) + 100)
            }
            if (p2 == 2)
            {
              p2 = (x^1.05)/((x^1.05) + 300)
            }
          }
          if (p1 == 1)
            p1 = 0
          if (p1 == 2)
            p1 = 0
          if (p2 == 1)
            p2 = 0
          if (p2 == 2)
            p2 = 0
          p = (1 - p1)*(1 - p2)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 223:333)
        {
          if (k %in% common)
          {
            if (p2 == 1)
            {
              p2 = (x^1.05)/((x^1.05) + 100)
            }
            if (p2 == 2)
            {
              p2 = (x^1.05)/((x^1.05) + 300)
            }
          }
          if (p2 == 1)
            p2 = 0
          if (p2 == 2)
            p2 = 0
          p = (1 - p2)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 334:444)
        {
          if (k %in% common)
          {
            if (p1 == 1)
            {
              p1 = (x^1.05)/((x^1.05) + 100)
            }
            if (p1 == 2)
            {
              p1 = (x^1.05)/((x^1.05) + 300)
            }
          }
          if (p1 == 1)
            p1 = 0
          if (p1 == 2)
            p1 = 0
          p = (1 - p1)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 445:555)
        {
          p = (1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
      }
    }
  }
  if (i == 1)
    sim1 = temp
  if (i == 2)
    sim2 = temp
  if (i == 3)
    sim3 = temp
  if (i == 4)
    sim4 = temp
  if (i == 5)
    sim5 = temp
  if (i == 6)
    sim6 = temp
  if (i == 7)
    sim7 = temp
  if (i == 8)
    sim8 = temp
  if (i == 9)
    sim9 = temp
  if (i == 10)
    sim10 = temp
  if (i == 11)
    sim11 = temp
  if (i == 12)
    sim12 = temp
  if (i == 13)
    sim13 = temp
  if (i == 14)
    sim14 = temp
  if (i == 15)
    sim15 = temp
  if (i == 16)
    sim16 = temp
  if (i == 17)
    sim17 = temp
  if (i == 18)
    sim18 = temp
  if (i == 19)
    sim19 = temp
  if (i == 20)
    sim20 = temp
  if (i == 21)
    sim21 = temp
  if (i == 22)
    sim22 = temp
  if (i == 23)
    sim23 = temp
  if (i == 24)
    sim24 = temp
  if (i == 25)
    sim25 = temp
  if (i == 26)
    sim26 = temp
  if (i == 27)
    sim27 = temp
  if (i == 28)
    sim28 = temp
  if (i == 29)
    sim29 = temp
  if (i == 30)
    sim30 = temp
  if (i == 31)
    sim31 = temp
  if (i == 32)
    sim32 = temp
  if (i == 33)
    sim33 = temp
  if (i == 34)
    sim34 = temp
  if (i == 35)
    sim35 = temp
  if (i == 36)
    sim36 = temp
  if (i == 37)
    sim37 = temp
  if (i == 38)
    sim38 = temp
  if (i == 39)
    sim39 = temp
  if (i == 40)
    sim40 = temp
  if (i == 41)
    sim41 = temp
  if (i == 42)
    sim42 = temp
  if (i == 43)
    sim43 = temp
  if (i == 44)
    sim44 = temp
  if (i == 45)
    sim45 = temp
  if (i == 46)
    sim46 = temp
  if (i == 47)
    sim47 = temp
  if (i == 48)
    sim48 = temp
  if (i == 49)
    sim49 = temp
  if (i == 50)
    sim50 = temp
  if (i == 51)
    sim51 = temp
  if (i == 52)
    sim52 = temp
  if (i == 53)
    sim53 = temp
  if (i == 54)
    sim54 = temp
  if (i == 55)
    sim55 = temp
  if (i == 56)
    sim56 = temp
  if (i == 57)
    sim57 = temp
  if (i == 58)
    sim58 = temp
  if (i == 59)
    sim59 = temp
  if (i == 60)
    sim60 = temp
  if (i == 61)
    sim61 = temp
  if (i == 62)
    sim62 = temp
  if (i == 63)
    sim63 = temp
  if (i == 64)
    sim64 = temp
  if (i == 65)
    sim65 = temp
  if (i == 66)
    sim66 = temp
  if (i == 67)
    sim67 = temp
  if (i == 68)
    sim68 = temp
  if (i == 69)
    sim69 = temp
  if (i == 70)
    sim70 = temp
  if (i == 71)
    sim71 = temp
  if (i == 72)
    sim72 = temp
  if (i == 73)
    sim73 = temp
  if (i == 74)
    sim74 = temp
  if (i == 75)
    sim75 = temp
  print(i)
}

###### Sim1 ######

for (i in 1:25)
{
  temp = frame
  for (j in 1:555)
  {
    for (k in 1:n)
    {
      p1 = sims1p$p1[i]
      p2 = sims1p$p2[i]
      p3 = sims1p$p3[i]
      x = sggro1m[j,k]
      y = ((x-1)^1.3)/(((x-1)^1.3) + 300)
      z = ((x-1)^1.3)/(((x-1)^1.3) + 200)
      if (x != 0)
      {
        if (j %in% 1:222)
        {
          if (k %in% common)
          {
            p1 = p1*0.1*y
            p2 = p2*0.1*z
          }
          if (p1 >= 1)
            p1 = 0
          if (p2 >= 1)
            p2 = 0
          p = (1 - p1)*(1 - p2)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 223:333)
        {
          if (k %in% common)
          {
            p2 = p2*0.1*z
          }
          if (p2 >= 1)
            p2 = 0
          p = (1 - p2)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 334:444)
        {
          if (k %in% common)
          {
            p1 = p1*0.1*y
          }
          if (p1 >= 1)
            p1 = 0
          p = (1 - p1)*(1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
        if (j %in% 445:555)
        {
          p = (1 - p3)  
          temp[j,k] = rbinom(1,x,p)
        }
      }
    }
  }
  if (i == 1)
    sim11 = temp
  if (i == 2)
    sim12 = temp
  if (i == 3)
    sim13 = temp
  if (i == 4)
    sim14 = temp
  if (i == 5)
    sim15 = temp
  if (i == 6)
    sim16 = temp
  if (i == 7)
    sim17 = temp
  if (i == 8)
    sim18 = temp
  if (i == 9)
    sim19 = temp
  if (i == 10)
    sim110 = temp
  if (i == 11)
    sim111 = temp
  if (i == 12)
    sim112 = temp
  if (i == 13)
    sim113 = temp
  if (i == 14)
    sim114 = temp
  if (i == 15)
    sim115 = temp
  if (i == 16)
    sim116 = temp
  if (i == 17)
    sim117 = temp
  if (i == 18)
    sim118 = temp
  if (i == 19)
    sim119 = temp
  if (i == 20)
    sim120 = temp
  if (i == 21)
    sim121 = temp
  if (i == 22)
    sim122 = temp
  if (i == 23)
    sim123 = temp
  if (i == 24)
    sim124 = temp
  if (i == 25)
    sim125 = temp
  print(i)
}

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim1

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv1 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim2

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv2 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim3

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv3 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim4

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv4 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim5

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv5 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim6

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv6 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim7

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv7 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim8

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv8 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim9

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv9 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim10

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv10 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim11

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv11 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim12

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv12 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim13

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv13 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim14

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv14 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim15

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv15 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim16

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv16 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim17

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv17 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim18

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv18 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim19

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv19 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim20

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv20 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim21

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv21 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim22

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv22 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim23

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv23 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim24

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv24 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim25

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv25 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim26

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv26 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim27

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv27 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim28

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv28 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim29

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv29 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim30

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv30 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim31

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv31 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim32

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv32 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim33

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv33 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim34

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv34 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim35

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv35 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim36

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv36 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim37

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv37 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim38

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv38 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim39

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv39 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim40

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv40 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim41

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv41 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim42

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv42 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim43

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv43 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim44

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv44 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim45

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv45 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim46

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv46 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim47

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv47 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim48

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv48 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim49

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv49 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim50

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv50 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim51

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv51 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim52

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv52 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim53

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv53 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim54

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv54 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim55

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv55 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim56

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv56 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim57

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv57 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim58

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv58 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim59

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv59 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim60

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv60 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim61

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv61 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim62

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv62 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim63

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv63 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim64

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv64 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim65

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv65 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim66

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv66 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim67

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv67 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim68

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv68 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim69

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv69 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim70

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv70 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim71

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv71 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim72

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv72 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim73

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv73 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim74

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv74 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim75

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

simdiv75 = rbind(a,b,c)

rm(a,a1,a2,a3,a4,a5,b,b1,b2,b3,b4,b5,c,c1,c2,c3,c4,c5,sglarge1,sgmedium1,sgsmall1,sl1,sl1large,sl1large1,sl1large2,sl1large5,sl1large6,sl1large7,sl1medium,sl1medium1,sl1medium2,sl1medium5,sl1medium6,sl1medium7,sl1small,sl1small1,sl1small2,sl1small5,sl1small6,sl1small7,sl2,sl2large,sl2large1,sl2large2,sl2large5,sl2large6,sl2large7,sl2medium,sl2medium1,sl2medium2,sl2medium5,sl2medium6,sl2medium7,sl2small,sl2small1,sl2small2,sl2small5,sl2small6,sl2small7,specbase,temp,tempspecbase11,tempspecbase12,tempspecbase21,tempspecbase22,tempspecbase51,tempspecbase52,tempspecbase61,tempspecbase62,tempspecbase71,tempspecbase72,count,ggp,i,j,sam)

###### Intercepts and r squares ######

a = data.frame(cbind(1:75,0))
a = a[,-c(1,2)]
a$int = 0
a$slp = 0
a$rsq = 0
a$mean = 0

temp = simdiv1
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[1] = r$coefficients[1,1]
a$slp[1] = r$coefficients[2,1]
a$rsq[1] = r$r.squared
a$mean[1] = mean(temp$trans)

temp = simdiv2
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[2] = r$coefficients[1,1]
a$slp[2] = r$coefficients[2,1]
a$rsq[2] = r$r.squared
a$mean[2] = mean(temp$trans)

temp = simdiv3
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[3] = r$coefficients[1,1]
a$slp[3] = r$coefficients[2,1]
a$rsq[3] = r$r.squared
a$mean[3] = mean(temp$trans)

temp = simdiv4
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[4] = r$coefficients[1,1]
a$slp[4] = r$coefficients[2,1]
a$rsq[4] = r$r.squared
a$mean[4] = mean(temp$trans)

temp = simdiv5
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[5] = r$coefficients[1,1]
a$slp[5] = r$coefficients[2,1]
a$rsq[5] = r$r.squared
a$mean[5] = mean(temp$trans)

temp = simdiv6
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[6] = r$coefficients[1,1]
a$slp[6] = r$coefficients[2,1]
a$rsq[6] = r$r.squared
a$mean[6] = mean(temp$trans)

temp = simdiv7
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[7] = r$coefficients[1,1]
a$slp[7] = r$coefficients[2,1]
a$rsq[7] = r$r.squared
a$mean[7] = mean(temp$trans)

temp = simdiv8
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[8] = r$coefficients[1,1]
a$slp[8] = r$coefficients[2,1]
a$rsq[8] = r$r.squared
a$mean[8] = mean(temp$trans)

temp = simdiv9
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[9] = r$coefficients[1,1]
a$slp[9] = r$coefficients[2,1]
a$rsq[9] = r$r.squared
a$mean[9] = mean(temp$trans)

temp = simdiv10
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[10] = r$coefficients[1,1]
a$slp[10] = r$coefficients[2,1]
a$rsq[10] = r$r.squared
a$mean[10] = mean(temp$trans)

temp = simdiv11
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[11] = r$coefficients[1,1]
a$slp[11] = r$coefficients[2,1]
a$rsq[11] = r$r.squared
a$mean[11] = mean(temp$trans)

temp = simdiv12
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[12] = r$coefficients[1,1]
a$slp[12] = r$coefficients[2,1]
a$rsq[12] = r$r.squared
a$mean[12] = mean(temp$trans)

temp = simdiv13
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[13] = r$coefficients[1,1]
a$slp[13] = r$coefficients[2,1]
a$rsq[13] = r$r.squared
a$mean[13] = mean(temp$trans)

temp = simdiv14
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[14] = r$coefficients[1,1]
a$slp[14] = r$coefficients[2,1]
a$rsq[14] = r$r.squared
a$mean[14] = mean(temp$trans)

temp = simdiv15
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[15] = r$coefficients[1,1]
a$slp[15] = r$coefficients[2,1]
a$rsq[15] = r$r.squared
a$mean[15] = mean(temp$trans)

temp = simdiv16
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[16] = r$coefficients[1,1]
a$slp[16] = r$coefficients[2,1]
a$rsq[16] = r$r.squared
a$mean[16] = mean(temp$trans)

temp = simdiv17
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[17] = r$coefficients[1,1]
a$slp[17] = r$coefficients[2,1]
a$rsq[17] = r$r.squared
a$mean[17] = mean(temp$trans)

temp = simdiv18
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[18] = r$coefficients[1,1]
a$slp[18] = r$coefficients[2,1]
a$rsq[18] = r$r.squared
a$mean[18] = mean(temp$trans)

temp = simdiv19
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[19] = r$coefficients[1,1]
a$slp[19] = r$coefficients[2,1]
a$rsq[19] = r$r.squared
a$mean[19] = mean(temp$trans)

temp = simdiv20
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[20] = r$coefficients[1,1]
a$slp[20] = r$coefficients[2,1]
a$rsq[20] = r$r.squared
a$mean[20] = mean(temp$trans)

temp = simdiv21
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[21] = r$coefficients[1,1]
a$slp[21] = r$coefficients[2,1]
a$rsq[21] = r$r.squared
a$mean[21] = mean(temp$trans)

temp = simdiv22
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[22] = r$coefficients[1,1]
a$slp[22] = r$coefficients[2,1]
a$rsq[22] = r$r.squared
a$mean[22] = mean(temp$trans)

temp = simdiv23
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[23] = r$coefficients[1,1]
a$slp[23] = r$coefficients[2,1]
a$rsq[23] = r$r.squared
a$mean[23] = mean(temp$trans)

temp = simdiv24
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[24] = r$coefficients[1,1]
a$slp[24] = r$coefficients[2,1]
a$rsq[24] = r$r.squared
a$mean[24] = mean(temp$trans)

temp = simdiv25
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[25] = r$coefficients[1,1]
a$slp[25] = r$coefficients[2,1]
a$rsq[25] = r$r.squared
a$mean[25] = mean(temp$trans)

temp = simdiv26
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[26] = r$coefficients[1,1]
a$slp[26] = r$coefficients[2,1]
a$rsq[26] = r$r.squared
a$mean[26] = mean(temp$trans)

temp = simdiv27
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[27] = r$coefficients[1,1]
a$slp[27] = r$coefficients[2,1]
a$rsq[27] = r$r.squared
a$mean[27] = mean(temp$trans)

temp = simdiv28
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[28] = r$coefficients[1,1]
a$slp[28] = r$coefficients[2,1]
a$rsq[28] = r$r.squared
a$mean[28] = mean(temp$trans)

temp = simdiv29
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[29] = r$coefficients[1,1]
a$slp[29] = r$coefficients[2,1]
a$rsq[29] = r$r.squared
a$mean[29] = mean(temp$trans)

temp = simdiv30
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[30] = r$coefficients[1,1]
a$slp[30] = r$coefficients[2,1]
a$rsq[30] = r$r.squared
a$mean[30] = mean(temp$trans)

temp = simdiv31
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[31] = r$coefficients[1,1]
a$slp[31] = r$coefficients[2,1]
a$rsq[31] = r$r.squared
a$mean[31] = mean(temp$trans)

temp = simdiv32
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[32] = r$coefficients[1,1]
a$slp[32] = r$coefficients[2,1]
a$rsq[32] = r$r.squared
a$mean[32] = mean(temp$trans)

temp = simdiv33
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[33] = r$coefficients[1,1]
a$slp[33] = r$coefficients[2,1]
a$rsq[33] = r$r.squared
a$mean[33] = mean(temp$trans)

temp = simdiv34
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[34] = r$coefficients[1,1]
a$slp[34] = r$coefficients[2,1]
a$rsq[34] = r$r.squared
a$mean[34] = mean(temp$trans)

temp = simdiv35
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[35] = r$coefficients[1,1]
a$slp[35] = r$coefficients[2,1]
a$rsq[35] = r$r.squared
a$mean[35] = mean(temp$trans)

temp = simdiv36
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[36] = r$coefficients[1,1]
a$slp[36] = r$coefficients[2,1]
a$rsq[36] = r$r.squared
a$mean[36] = mean(temp$trans)

temp = simdiv37
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[37] = r$coefficients[1,1]
a$slp[37] = r$coefficients[2,1]
a$rsq[37] = r$r.squared
a$mean[37] = mean(temp$trans)

temp = simdiv38
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[38] = r$coefficients[1,1]
a$slp[38] = r$coefficients[2,1]
a$rsq[38] = r$r.squared
a$mean[38] = mean(temp$trans)

temp = simdiv39
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[39] = r$coefficients[1,1]
a$slp[39] = r$coefficients[2,1]
a$rsq[39] = r$r.squared
a$mean[39] = mean(temp$trans)

temp = simdiv40
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[40] = r$coefficients[1,1]
a$slp[40] = r$coefficients[2,1]
a$rsq[40] = r$r.squared
a$mean[40] = mean(temp$trans)

temp = simdiv41
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[41] = r$coefficients[1,1]
a$slp[41] = r$coefficients[2,1]
a$rsq[41] = r$r.squared
a$mean[41] = mean(temp$trans)

temp = simdiv42
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[42] = r$coefficients[1,1]
a$slp[42] = r$coefficients[2,1]
a$rsq[42] = r$r.squared
a$mean[42] = mean(temp$trans)

temp = simdiv43
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[43] = r$coefficients[1,1]
a$slp[43] = r$coefficients[2,1]
a$rsq[43] = r$r.squared
a$mean[43] = mean(temp$trans)

temp = simdiv44
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[44] = r$coefficients[1,1]
a$slp[44] = r$coefficients[2,1]
a$rsq[44] = r$r.squared
a$mean[44] = mean(temp$trans)

temp = simdiv45
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[45] = r$coefficients[1,1]
a$slp[45] = r$coefficients[2,1]
a$rsq[45] = r$r.squared
a$mean[45] = mean(temp$trans)

temp = simdiv46
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[46] = r$coefficients[1,1]
a$slp[46] = r$coefficients[2,1]
a$rsq[46] = r$r.squared
a$mean[46] = mean(temp$trans)

temp = simdiv47
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[47] = r$coefficients[1,1]
a$slp[47] = r$coefficients[2,1]
a$rsq[47] = r$r.squared
a$mean[47] = mean(temp$trans)

temp = simdiv48
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[48] = r$coefficients[1,1]
a$slp[48] = r$coefficients[2,1]
a$rsq[48] = r$r.squared
a$mean[48] = mean(temp$trans)

temp = simdiv49
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[49] = r$coefficients[1,1]
a$slp[49] = r$coefficients[2,1]
a$rsq[49] = r$r.squared
a$mean[49] = mean(temp$trans)

temp = simdiv50
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[50] = r$coefficients[1,1]
a$slp[50] = r$coefficients[2,1]
a$rsq[50] = r$r.squared
a$mean[50] = mean(temp$trans)

temp = simdiv51
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[51] = r$coefficients[1,1]
a$slp[51] = r$coefficients[2,1]
a$rsq[51] = r$r.squared
a$mean[51] = mean(temp$trans)

temp = simdiv52
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[52] = r$coefficients[1,1]
a$slp[52] = r$coefficients[2,1]
a$rsq[52] = r$r.squared
a$mean[52] = mean(temp$trans)

temp = simdiv53
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[53] = r$coefficients[1,1]
a$slp[53] = r$coefficients[2,1]
a$rsq[53] = r$r.squared
a$mean[53] = mean(temp$trans)

temp = simdiv54
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[54] = r$coefficients[1,1]
a$slp[54] = r$coefficients[2,1]
a$rsq[54] = r$r.squared
a$mean[54] = mean(temp$trans)

temp = simdiv55
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[55] = r$coefficients[1,1]
a$slp[55] = r$coefficients[2,1]
a$rsq[55] = r$r.squared
a$mean[55] = mean(temp$trans)

temp = simdiv56
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[56] = r$coefficients[1,1]
a$slp[56] = r$coefficients[2,1]
a$rsq[56] = r$r.squared
a$mean[56] = mean(temp$trans)

temp = simdiv57
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[57] = r$coefficients[1,1]
a$slp[57] = r$coefficients[2,1]
a$rsq[57] = r$r.squared
a$mean[57] = mean(temp$trans)

temp = simdiv58
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[58] = r$coefficients[1,1]
a$slp[58] = r$coefficients[2,1]
a$rsq[58] = r$r.squared
a$mean[58] = mean(temp$trans)

temp = simdiv59
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[59] = r$coefficients[1,1]
a$slp[59] = r$coefficients[2,1]
a$rsq[59] = r$r.squared
a$mean[59] = mean(temp$trans)

temp = simdiv60
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[60] = r$coefficients[1,1]
a$slp[60] = r$coefficients[2,1]
a$rsq[60] = r$r.squared
a$mean[60] = mean(temp$trans)

temp = simdiv61
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[61] = r$coefficients[1,1]
a$slp[61] = r$coefficients[2,1]
a$rsq[61] = r$r.squared
a$mean[61] = mean(temp$trans)

temp = simdiv62
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[62] = r$coefficients[1,1]
a$slp[62] = r$coefficients[2,1]
a$rsq[62] = r$r.squared
a$mean[62] = mean(temp$trans)

temp = simdiv63
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[63] = r$coefficients[1,1]
a$slp[63] = r$coefficients[2,1]
a$rsq[63] = r$r.squared
a$mean[63] = mean(temp$trans)

temp = simdiv64
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[64] = r$coefficients[1,1]
a$slp[64] = r$coefficients[2,1]
a$rsq[64] = r$r.squared
a$mean[64] = mean(temp$trans)

temp = simdiv65
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[65] = r$coefficients[1,1]
a$slp[65] = r$coefficients[2,1]
a$rsq[65] = r$r.squared
a$mean[65] = mean(temp$trans)

temp = simdiv66
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[66] = r$coefficients[1,1]
a$slp[66] = r$coefficients[2,1]
a$rsq[66] = r$r.squared
a$mean[66] = mean(temp$trans)

temp = simdiv67
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[67] = r$coefficients[1,1]
a$slp[67] = r$coefficients[2,1]
a$rsq[67] = r$r.squared
a$mean[67] = mean(temp$trans)

temp = simdiv68
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[68] = r$coefficients[1,1]
a$slp[68] = r$coefficients[2,1]
a$rsq[68] = r$r.squared
a$mean[68] = mean(temp$trans)

temp = simdiv69
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[69] = r$coefficients[1,1]
a$slp[69] = r$coefficients[2,1]
a$rsq[69] = r$r.squared
a$mean[69] = mean(temp$trans)

temp = simdiv70
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[70] = r$coefficients[1,1]
a$slp[70] = r$coefficients[2,1]
a$rsq[70] = r$r.squared
a$mean[70] = mean(temp$trans)

temp = simdiv71
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[71] = r$coefficients[1,1]
a$slp[71] = r$coefficients[2,1]
a$rsq[71] = r$r.squared
a$mean[71] = mean(temp$trans)

temp = simdiv72
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[72] = r$coefficients[1,1]
a$slp[72] = r$coefficients[2,1]
a$rsq[72] = r$r.squared
a$mean[72] = mean(temp$trans)

temp = simdiv73
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[73] = r$coefficients[1,1]
a$slp[73] = r$coefficients[2,1]
a$rsq[73] = r$r.squared
a$mean[73] = mean(temp$trans)

temp = simdiv74
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[74] = r$coefficients[1,1]
a$slp[74] = r$coefficients[2,1]
a$rsq[74] = r$r.squared
a$mean[74] = mean(temp$trans)

temp = simdiv75
temp = temp[temp$plot == "1" & temp$size == "Small",]
r = summary(lm(data = temp, trans ~ initial))
a$int[75] = r$coefficients[1,1]
a$slp[75] = r$coefficients[2,1]
a$rsq[75] = r$r.squared
a$mean[75] = mean(temp$trans)

write.csv(a,"C:/Users/ashwinv/Desktop/a.csv")

###### Simulation summary ######

simsum1 = read.csv("C:/Users/ashwinv/Desktop/simsum1.csv") 
simsum1$type = as.factor(simsum1$type)
simsum1$size = as.factor(simsum1$size)
simsum1$plot = as.factor(simsum1$plot)
simsum1$dd = "Density dependent"
simsum1[simsum1$type == "nodd",]$dd = "Density independent"
#simint = summarySE(simsum1,groupvars = c("type","plot","size"),measurevar = "int")
#simslope = summarySE(simsum1,groupvars = c("type","plot","size"),measurevar = "slope")
#simrsq = summarySE(simsum1,groupvars = c("type","plot","size"),measurevar = "rsq")
#simmean = summarySE(simsum1,groupvars = c("type","plot","size"),measurevar = "mean")
simmean1 = summarySE(simsum1,groupvars = c("dd","plot"),measurevar = "mean")











###### Post simulation sims no effect of size ######

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim11

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div1 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim12

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div2 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim13

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div3 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim14

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div4 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim15

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div5 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim16

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div6 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim17

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div7 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim18

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div8 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim19

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div9 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim110

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div10 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim111

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div11 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim112

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div12 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim113

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div13 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim114

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div14 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim115

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div15 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim116

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div16 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim117

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div17 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim118

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div18 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim119

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div19 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim120

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div20 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim121

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div21 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim122

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div22 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim123

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div23 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim124

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div24 = rbind(a,b,c)

###### Accumulation curves by group ######
###### S2,S6,S8,S9,S10,S15,S16,S17,S18,S19,S33 ######
###### S4,S5,S11,S12,S14,S7 ######
###### S1,S3,S13,S39 ######

sl1 = sggro1m
sl2 = sim125

sl1small = sl1[sggro1$site == "S2" | sggro1$site == "S6" | sggro1$site == "S8" | sggro1$site == "S9" | sggro1$site == "S10" | sggro1$site == "S15" | sggro1$site == "S16" | sggro1$site == "S17" | sggro1$site == "S18" | sggro1$site == "S19" | sggro1$site == "S33",]
sl1medium = sl1[sggro1$site == "S4" | sggro1$site == "S5" | sggro1$site == "S11" | sggro1$site == "S12" | sggro1$site == "S14" | sggro1$site == "S7",]
sl1large = sl1[sggro1$site == "S1" | sggro1$site == "S3" | sggro1$site == "S13" | sggro1$site == "S39",]

sl2small = sl2[sggro2$site == "S2" | sggro2$site == "S6" | sggro2$site == "S8" | sggro2$site == "S9" | sggro2$site == "S10" | sggro2$site == "S15" | sggro2$site == "S16" | sggro2$site == "S17" | sggro2$site == "S18" | sggro2$site == "S19" | sggro2$site == "S33",]
sl2medium = sl2[sggro2$site == "S4" | sggro2$site == "S5" | sggro2$site == "S11" | sggro2$site == "S12" | sggro2$site == "S14" | sggro2$site == "S7",]
sl2large = sl2[sggro2$site == "S1" | sggro2$site == "S3" | sggro2$site == "S13" | sggro2$site == "S39",]

sl1small1 = sl1small[1:33,]
sl1small2 = sl1small[34:66,]
sl1small5 = sl1small[67:99,]
sl1small6 = sl1small[100:132,]
sl1small7 = sl1small[133:165,]

sl2small1 = sl2small[1:33,]
sl2small2 = sl2small[34:66,]
sl2small5 = sl2small[67:99,]
sl2small6 = sl2small[100:132,]
sl2small7 = sl2small[133:165,]

sl1medium1 = sl1medium[1:39,]
sl1medium2 = sl1medium[40:78,]
sl1medium5 = sl1medium[79:117,]
sl1medium6 = sl1medium[118:156,]
sl1medium7 = sl1medium[157:195,]

sl2medium1 = sl2medium[1:39,]
sl2medium2 = sl2medium[40:78,]
sl2medium5 = sl2medium[79:117,]
sl2medium6 = sl2medium[118:156,]
sl2medium7 = sl2medium[157:195,]

sl1large1 = sl1large[1:39,]
sl1large2 = sl1large[40:78,]
sl1large5 = sl1large[79:117,]
sl1large6 = sl1large[118:156,]
sl1large7 = sl1large[157:195,]

sl2large1 = sl2large[1:39,]
sl2large2 = sl2large[40:78,]
sl2large5 = sl2large[79:117,]
sl2large6 = sl2large[118:156,]
sl2large7 = sl2large[157:195,]

###### Separate plots ######

a = length(sl1small1[,1])

sgsmall1 = data.frame(cbind(1:(a*300),0))
sgsmall1 = sgsmall1[,-c(1,2)]
sgsmall1$scale = rep(1:a,300)
sgsmall1$run = rep(1:300,each = a)
sgsmall1$plot11 = sgsmall1$plot21 = sgsmall1$plot51 = sgsmall1$plot61 = sgsmall1$plot71 = 0
sgsmall1$plot12 = sgsmall1$plot22 = sgsmall1$plot52 = sgsmall1$plot62 = sgsmall1$plot72 = 0
sgsmall1$rich11 = sgsmall1$rich21 = sgsmall1$rich51 = sgsmall1$rich61 = sgsmall1$rich71 = 0
sgsmall1$rich12 = sgsmall1$rich22 = sgsmall1$rich52 = sgsmall1$rich62 = sgsmall1$rich72 = 0

count = 0
specbase = sl1small1[1,]
specbase[,] = 0


for (i in 1:300)
{
  print(i)
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1small1[j,]
    tempspecbase12 = tempspecbase12 + sl2small1[j,]
    tempspecbase21 = tempspecbase21 + sl1small2[j,]
    tempspecbase22 = tempspecbase22 + sl2small2[j,]
    tempspecbase51 = tempspecbase51 + sl1small5[j,]
    tempspecbase52 = tempspecbase52 + sl2small5[j,]
    tempspecbase61 = tempspecbase61 + sl1small6[j,]
    tempspecbase62 = tempspecbase62 + sl2small6[j,]
    tempspecbase71 = tempspecbase71 + sl1small7[j,]
    tempspecbase72 = tempspecbase72 + sl2small7[j,]
    sgsmall1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgsmall1$rich11[count] = specnumber(tempspecbase11)
    sgsmall1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgsmall1$rich12[count] = specnumber(tempspecbase12)
    sgsmall1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgsmall1$rich21[count] = specnumber(tempspecbase21)
    sgsmall1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgsmall1$rich22[count] = specnumber(tempspecbase22)
    sgsmall1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgsmall1$rich51[count] = specnumber(tempspecbase51)
    sgsmall1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgsmall1$rich52[count] = specnumber(tempspecbase52)
    sgsmall1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgsmall1$rich61[count] = specnumber(tempspecbase61)
    sgsmall1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgsmall1$rich62[count] = specnumber(tempspecbase62)
    sgsmall1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgsmall1$rich71[count] = specnumber(tempspecbase71)
    sgsmall1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgsmall1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1medium1[,1])

sgmedium1 = data.frame(cbind(1:(a*300),0))
sgmedium1 = sgmedium1[,-c(1,2)]
sgmedium1$scale = rep(1:a,300)
sgmedium1$run = rep(1:300,each = a)
sgmedium1$plot11 = sgmedium1$plot21 = sgmedium1$plot51 = sgmedium1$plot61 = sgmedium1$plot71 = 0
sgmedium1$plot12 = sgmedium1$plot22 = sgmedium1$plot52 = sgmedium1$plot62 = sgmedium1$plot72 = 0
sgmedium1$rich11 = sgmedium1$rich21 = sgmedium1$rich51 = sgmedium1$rich61 = sgmedium1$rich71 = 0
sgmedium1$rich12 = sgmedium1$rich22 = sgmedium1$rich52 = sgmedium1$rich62 = sgmedium1$rich72 = 0

count = 0
specbase = sl1medium1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1medium1[j,]
    tempspecbase12 = tempspecbase12 + sl2medium1[j,]
    tempspecbase21 = tempspecbase21 + sl1medium2[j,]
    tempspecbase22 = tempspecbase22 + sl2medium2[j,]
    tempspecbase51 = tempspecbase51 + sl1medium5[j,]
    tempspecbase52 = tempspecbase52 + sl2medium5[j,]
    tempspecbase61 = tempspecbase61 + sl1medium6[j,]
    tempspecbase62 = tempspecbase62 + sl2medium6[j,]
    tempspecbase71 = tempspecbase71 + sl1medium7[j,]
    tempspecbase72 = tempspecbase72 + sl2medium7[j,]
    sgmedium1$plot11[count] = diversity(tempspecbase11,"shannon")
    sgmedium1$rich11[count] = specnumber(tempspecbase11)
    sgmedium1$plot12[count] = diversity(tempspecbase12,"shannon")
    sgmedium1$rich12[count] = specnumber(tempspecbase12)
    sgmedium1$plot21[count] = diversity(tempspecbase21,"shannon")
    sgmedium1$rich21[count] = specnumber(tempspecbase21)
    sgmedium1$plot22[count] = diversity(tempspecbase22,"shannon")
    sgmedium1$rich22[count] = specnumber(tempspecbase22)
    sgmedium1$plot51[count] = diversity(tempspecbase51,"shannon")
    sgmedium1$rich51[count] = specnumber(tempspecbase51)
    sgmedium1$plot52[count] = diversity(tempspecbase52,"shannon")
    sgmedium1$rich52[count] = specnumber(tempspecbase52)
    sgmedium1$plot61[count] = diversity(tempspecbase61,"shannon")
    sgmedium1$rich61[count] = specnumber(tempspecbase61)
    sgmedium1$plot62[count] = diversity(tempspecbase62,"shannon")
    sgmedium1$rich62[count] = specnumber(tempspecbase62)
    sgmedium1$plot71[count] = diversity(tempspecbase71,"shannon")
    sgmedium1$rich71[count] = specnumber(tempspecbase71)
    sgmedium1$plot72[count] = diversity(tempspecbase72,"shannon")
    sgmedium1$rich72[count] = specnumber(tempspecbase72)
  }
}

###### Separate plots ######

a = length(sl1large1[,1])

sglarge1 = data.frame(cbind(1:(a*300),0))
sglarge1 = sglarge1[,-c(1,2)]
sglarge1$scale = rep(1:a,300)
sglarge1$run = rep(1:300,each = a)
sglarge1$plot11 = sglarge1$plot21 = sglarge1$plot51 = sglarge1$plot61 = sglarge1$plot71 = 0
sglarge1$plot12 = sglarge1$plot22 = sglarge1$plot52 = sglarge1$plot62 = sglarge1$plot72 = 0
sglarge1$rich11 = sglarge1$rich21 = sglarge1$rich51 = sglarge1$rich61 = sglarge1$rich71 = 0
sglarge1$rich12 = sglarge1$rich22 = sglarge1$rich52 = sglarge1$rich62 = sglarge1$rich72 = 0

count = 0
specbase = sl1large1[1,]
specbase[,] = 0


for (i in 1:300)
{
  sam = sample(1:a,a)
  tempspecbase11 = specbase
  tempspecbase12 = specbase
  tempspecbase21 = specbase
  tempspecbase22 = specbase
  tempspecbase51 = specbase
  tempspecbase52 = specbase
  tempspecbase61 = specbase
  tempspecbase62 = specbase
  tempspecbase71 = specbase
  tempspecbase72 = specbase
  
  for (j in sam)
  {
    count = count + 1
    tempspecbase11 = tempspecbase11 + sl1large1[j,]
    tempspecbase12 = tempspecbase12 + sl2large1[j,]
    tempspecbase21 = tempspecbase21 + sl1large2[j,]
    tempspecbase22 = tempspecbase22 + sl2large2[j,]
    tempspecbase51 = tempspecbase51 + sl1large5[j,]
    tempspecbase52 = tempspecbase52 + sl2large5[j,]
    tempspecbase61 = tempspecbase61 + sl1large6[j,]
    tempspecbase62 = tempspecbase62 + sl2large6[j,]
    tempspecbase71 = tempspecbase71 + sl1large7[j,]
    tempspecbase72 = tempspecbase72 + sl2large7[j,]
    sglarge1$plot11[count] = diversity(tempspecbase11,"shannon")
    sglarge1$rich11[count] = specnumber(tempspecbase11)
    sglarge1$plot12[count] = diversity(tempspecbase12,"shannon")
    sglarge1$rich12[count] = specnumber(tempspecbase12)
    sglarge1$plot21[count] = diversity(tempspecbase21,"shannon")
    sglarge1$rich21[count] = specnumber(tempspecbase21)
    sglarge1$plot22[count] = diversity(tempspecbase22,"shannon")
    sglarge1$rich22[count] = specnumber(tempspecbase22)
    sglarge1$plot51[count] = diversity(tempspecbase51,"shannon")
    sglarge1$rich51[count] = specnumber(tempspecbase51)
    sglarge1$plot52[count] = diversity(tempspecbase52,"shannon")
    sglarge1$rich52[count] = specnumber(tempspecbase52)
    sglarge1$plot61[count] = diversity(tempspecbase61,"shannon")
    sglarge1$rich61[count] = specnumber(tempspecbase61)
    sglarge1$plot62[count] = diversity(tempspecbase62,"shannon")
    sglarge1$rich62[count] = specnumber(tempspecbase62)
    sglarge1$plot71[count] = diversity(tempspecbase71,"shannon")
    sglarge1$rich71[count] = specnumber(tempspecbase71)
    sglarge1$plot72[count] = diversity(tempspecbase72,"shannon")
    sglarge1$rich72[count] = specnumber(tempspecbase72)
  }
}

sgsmall1$shannonsgsgtrans1 = sgsmall1$plot12 - sgsmall1$plot11
sgsmall1$shannonsgsgtrans2 = sgsmall1$plot22 - sgsmall1$plot21
sgsmall1$shannonsgsgtrans5 = sgsmall1$plot52 - sgsmall1$plot51
sgsmall1$shannonsgsgtrans6 = sgsmall1$plot62 - sgsmall1$plot61
sgsmall1$shannonsgsgtrans7 = sgsmall1$plot72 - sgsmall1$plot71

sgmedium1$shannonsgsgtrans1 = sgmedium1$plot12 - sgmedium1$plot11
sgmedium1$shannonsgsgtrans2 = sgmedium1$plot22 - sgmedium1$plot21
sgmedium1$shannonsgsgtrans5 = sgmedium1$plot52 - sgmedium1$plot51
sgmedium1$shannonsgsgtrans6 = sgmedium1$plot62 - sgmedium1$plot61
sgmedium1$shannonsgsgtrans7 = sgmedium1$plot72 - sgmedium1$plot71

sglarge1$shannonsgsgtrans1 = sglarge1$plot12 - sglarge1$plot11
sglarge1$shannonsgsgtrans2 = sglarge1$plot22 - sglarge1$plot21
sglarge1$shannonsgsgtrans5 = sglarge1$plot52 - sglarge1$plot51
sglarge1$shannonsgsgtrans6 = sglarge1$plot62 - sglarge1$plot61
sglarge1$shannonsgsgtrans7 = sglarge1$plot72 - sglarge1$plot71

###### Build the 2 data frames ######

a = sgsmall1[sgsmall1$scale == 20,]
b = sgmedium1[sgmedium1$scale == 20,]
c = sglarge1[sglarge1$scale == 20,]

a1 = a[,c(2,7,12,17,22,23)]
a1$size = as.factor("Small")
a1$plot = as.factor(1)
names(a1)[2:6] = c("initial","final","richini","richfin","trans")
a2 = a[,c(2,6,11,16,21,24)]
a2$size = as.factor("Small")
a2$plot = as.factor(2)
names(a2)[2:6] = c("initial","final","richini","richfin","trans")
a3 = a[,c(2,5,10,15,20,25)]
a3$size = as.factor("Small")
a3$plot = as.factor(5)
names(a3)[2:6] = c("initial","final","richini","richfin","trans")
a4 = a[,c(2,4,9,14,19,26)]
a4$size = as.factor("Small")
a4$plot = as.factor(6)
names(a4)[2:6] = c("initial","final","richini","richfin","trans")
a5 = a[,c(2,3,8,13,18,27)]
a5$size = as.factor("Small")
a5$plot = as.factor(7)
names(a5)[2:6] = c("initial","final","richini","richfin","trans")

a = rbind(a1,a2,a3,a4,a5)

b1 = b[,c(2,7,12,17,22,23)]
b1$size = as.factor("Medium")
b1$plot = as.factor(1)
names(b1)[2:6] = c("initial","final","richini","richfin","trans")
b2 = b[,c(2,6,11,16,21,24)]
b2$size = as.factor("Medium")
b2$plot = as.factor(2)
names(b2)[2:6] = c("initial","final","richini","richfin","trans")
b3 = b[,c(2,5,10,15,20,25)]
b3$size = as.factor("Medium")
b3$plot = as.factor(5)
names(b3)[2:6] = c("initial","final","richini","richfin","trans")
b4 = b[,c(2,4,9,14,19,26)]
b4$size = as.factor("Medium")
b4$plot = as.factor(6)
names(b4)[2:6] = c("initial","final","richini","richfin","trans")
b5 = b[,c(2,3,8,13,18,27)]
b5$size = as.factor("Medium")
b5$plot = as.factor(7)
names(b5)[2:6] = c("initial","final","richini","richfin","trans")

b = rbind(b1,b2,b3,b4,b5)

c1 = c[,c(2,7,12,17,22,23)]
c1$size = as.factor("Large")
c1$plot = as.factor(1)
names(c1)[2:6] = c("initial","final","richini","richfin","trans")
c2 = c[,c(2,6,11,16,21,24)]
c2$size = as.factor("Large")
c2$plot = as.factor(2)
names(c2)[2:6] = c("initial","final","richini","richfin","trans")
c3 = c[,c(2,5,10,15,20,25)]
c3$size = as.factor("Large")
c3$plot = as.factor(5)
names(c3)[2:6] = c("initial","final","richini","richfin","trans")
c4 = c[,c(2,4,9,14,19,26)]
c4$size = as.factor("Large")
c4$plot = as.factor(6)
names(c4)[2:6] = c("initial","final","richini","richfin","trans")
c5 = c[,c(2,3,8,13,18,27)]
c5$size = as.factor("Large")
c5$plot = as.factor(7)
names(c5)[2:6] = c("initial","final","richini","richfin","trans")

c = rbind(c1,c2,c3,c4,c5)

sim1div25 = rbind(a,b,c)